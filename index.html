<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Froot · Illumina — Color · Song · Ritual</title>
<meta name="description" content="Froot — your Illumina color + song + seed ritual home. Daily pages, Marina-forward aesthetic, instant tint overlay, compact track tabs, and a pinned mini-player." />
<meta name="theme-color" content="#0b0d11">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
  :root{
    --bg1:#161824;
    --bg2:#1b2033;
    --ink:#eef1ff;
    --ink-dim:#cfd3ea;
    --panel:#0f121a;
    --card:rgba(12,15,23,.62);
    --line:rgba(255,255,255,.12);
    --gold:#ffd26f;
    --lilac:#b9a7ff;
    --accent:#ffdca6;
    --border:rgba(255,255,255,.14);
    --chip:rgba(255,255,255,.06);
    --grad1:#F7C873; /* honey amber */
    --grad2:#A89FBF; /* lavender grey */
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0}
  body{
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial;
    color:var(--ink);
    background: radial-gradient(1200px 800px at 20% -10%, #20243a 0%, transparent 70%),
                linear-gradient(135deg,var(--bg1),var(--bg2));
    background-size:160% 160%;
    animation: bgshift 42s ease-in-out infinite alternate;
  }
  @keyframes bgshift{0%{background-position:0% 0%}100%{background-position:100% 100%}}
  @media (prefers-reduced-motion: reduce){ body{animation:none} }

  a{color:var(--accent);text-decoration:none}
  .wrap{max-width:1120px;margin:0 auto;padding:16px;display:grid;gap:16px}

  header.site{
    display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap
  }
  .brand{display:flex;gap:10px;align-items:center}
  .glyph{width:26px;height:26px;border-radius:8px;background:linear-gradient(135deg,var(--grad1),var(--grad2));box-shadow:0 0 0 1px var(--line) inset}
  h1{margin:0;font-size:20px;font-weight:750;letter-spacing:.25px}
  .chips{display:flex;gap:8px;flex-wrap:wrap}
  .chip{background:var(--chip);border:1px solid var(--line);border-radius:999px;padding:6px 10px;font-size:12px}

  .grid{display:grid;gap:16px}
  @media(min-width:980px){ .grid{grid-template-columns:1.35fr 1fr} }

  .card{background:var(--card);backdrop-filter:blur(10px) saturate(120%);border:1px solid var(--line);border-radius:18px;padding:14px}
  .h{margin:0 0 8px;font-size:16px;font-weight:750;opacity:.9;letter-spacing:.15px;color:var(--ink)}
  .muted{opacity:.8}

  /* Now row: player + side controls (incl. tint rail) */
  .nowrow{display:grid;gap:12px}
  @media(min-width:700px){ .nowrow{grid-template-columns:1fr 280px} }

  .nowplayer{position:relative}
  .player{width:100%;aspect-ratio:16/9;border:0;border-radius:14px;background:#000;overflow:hidden}
  #tintOverlay{
    position:absolute; inset:0; background:transparent; mix-blend-mode:multiply;
    pointer-events:none; border-radius:14px; transition:opacity .08s linear;
  }

  .sideBtns{display:grid;gap:10px;align-content:start}
  .pillBtn{background:#0e1118;color:var(--ink);border:1px solid var(--line);border-radius:12px;padding:10px 12px;font-size:14px;width:100%;text-align:left}
  .pillBtn[aria-pressed="true"]{border-color:var(--gold);box-shadow:0 0 0 2px rgba(255,210,111,.16)}

  /* Tint rail (compact, sits by the player) */
  .tintRail{display:grid;gap:8px}
  .tintRow{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .tintLbl{font-size:12px;opacity:.85}
  #tintPctMini{width:100%}
  .pctChip{background:#0e1118;border:1px solid var(--line);padding:6px 10px;border-radius:999px;font-size:12px}
  .tintDots{display:flex;gap:8px;flex-wrap:wrap}
  .tintDot{
    width:18px;height:18px;border-radius:50%;border:1px solid var(--border);
    box-shadow:inset 0 0 0 1px rgba(0,0,0,.25);cursor:pointer
  }
  .tintDot[aria-current="true"]{outline:2px solid var(--gold)}

  /* Compact track buttons */
  .track-tabs{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  .tab{
    background:#171b2c;border:1px solid var(--border);color:#eaeaff;
    padding:8px 10px;border-radius:999px;font-size:12px;letter-spacing:.2px
  }
  .tab[aria-current="true"], .tab:focus{outline:none;border-color:var(--gold);box-shadow:0 0 0 2px rgba(255,210,111,.15)}
  .tab:hover{background:rgba(255,255,255,.06)}

  /* Home links */
  .home-links .h{margin-bottom:6px}
  .day-link{display:inline-block;padding:8px 12px;border:1px solid var(--line);border-radius:999px}
  .day-link:hover{background:rgba(255,255,255,.06)}

  /* Pinned mini-player */
  .player--pinned{
    position:fixed; right:env(safe-area-inset-right,12px);
    bottom:calc(env(safe-area-inset-bottom,12px) + 12px);
    width:min(340px, 44vw); aspect-ratio:16/9; z-index:9999; border-radius:12px; overflow:hidden;
    box-shadow:0 8px 24px rgba(0,0,0,.45); background:#000;
  }
  @media (max-width:520px){ .player--pinned{width:min(300px, 86vw)} }

  footer.site{opacity:.75;font-size:12px}
</style>
</head>
<body>
<main class="wrap">

  <!-- Site header -->
  <header class="site">
    <div class="brand">
      <span class="glyph" aria-hidden="true"></span>
      <h1>Froot — Illumina</h1>
    </div>
    <div class="chips">
      <span class="chip">Marina-forward</span>
      <span class="chip">Instant Tint</span>
      <span class="chip">Pinned Mini-Player</span>
    </div>
  </header>

  <!-- Quick links (Day 14 entry) -->
  <section class="card home-links">
    <h2 class="h">Daily Pages</h2>
    <a class="day-link" href="/day14/">Day 14 — Tornado Warnings (Sabrina)</a>
  </section>

  <!-- Now Playing -->
  <section class="card">
    <h2 class="h">Now Playing</h2>

    <div class="nowrow">
      <!-- Player + live tint overlay -->
      <div class="nowplayer" id="nowPlayer">
        <iframe id="yt" class="player" allow="autoplay; encrypted-media; picture-in-picture" title="Froot Player"></iframe>
        <div id="tintOverlay" aria-hidden="true"></div>
      </div>

      <!-- Controls at the player's side (together for immediate responsiveness) -->
      <div class="sideBtns">
        <button id="pinToggle" class="pillBtn" aria-pressed="false">📌 Pin Video</button>
        <button id="muteToggle" class="pillBtn" aria-pressed="false">🔊 Mute</button>

        <!-- Compact tint rail -->
        <div class="tintRail" aria-label="Tint controls">
          <div class="tintDots" id="tintDots" role="group" aria-label="Tint palette"></div>
          <div class="tintRow">
            <label for="tintPctMini" class="tintLbl">Tint</label>
            <input id="tintPctMini" type="range" min="0" max="80" value="35" />
            <div id="tintChipMini" class="pctChip">35%</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Compact title buttons (Alter-style) -->
    <nav class="track-tabs" aria-label="Tracks" id="trackTabs"></nav>
  </section>

  <!-- Week vibe (optional palettes) -->
  <section class="card">
    <h2 class="h">This Week’s Froot Vibe</h2>
    <div class="muted">Big expressive palettes belong up here (week header). The mini tint rail by the player is for instant color feel.</div>
  </section>

  <footer class="site">Froot · Illumina — color · song · ritual · reflection</footer>
</main>

<script>
  /* =========================
     Data
  ========================== */
  var PLAYLIST = [
    { title: "Sabrina — Tornado Warnings", id: "_QhYpF6F5ug", accent:"#F7C873" },
    { title: "Marina — Froot",             id: "9P0y2k4lQZE", accent:"#A89FBF" },
    { title: "Marina — Blue",              id: "GzU8KqOY8YA", accent:"#6AB6FF" },
    { title: "Marina — Happy",             id: "e3Pss0D7nXQ", accent:"#B68BFF" }
  ];
  var DEFAULT_VIDEO = PLAYLIST[0].id;
  var DEFAULT_TINT = "#A89FBF";
  var DEFAULT_TINT_PCT = 35;

  /* =========================
     Helpers
  ========================== */
  function $(id){ return document.getElementById(id); }
  function hexToRgb(hex){
    hex = (hex||"").replace("#",""); if(hex.length===3){ hex = hex.split("").map(x=>x+x).join(""); }
    var n = parseInt(hex||"000000", 16); return { r:(n>>16)&255, g:(n>>8)&255, b:n&255 };
  }

  /* =========================
     Build player + UI
  ========================== */
  var yt = $("yt");
  var overlay = $("tintOverlay");
  var pinBtn = $("pinToggle");
  var muteBtn = $("muteToggle");
  var tintDots = $("tintDots");
  var tintPctMini = $("tintPctMini");
  var tintChipMini = $("tintChipMini");
  var trackTabs = $("trackTabs");

  function setIframe(id, auto){
    var p = new URLSearchParams({
      autoplay: auto ? 1 : 0,
      modestbranding: 1,
      rel: 0,
      color: "white",
      playsinline: 1,
      loop: 1,
      playlist: id
    });
    yt.src = "https://www.youtube.com/embed/" + id + "?" + p.toString();
  }

  // Initial video (restore last if present)
  var last = localStorage.getItem("froot:last_video") || DEFAULT_VIDEO;
  setIframe(last, false);

  // Track tabs (compact title buttons)
  function renderTabs(){
    trackTabs.innerHTML = "";
    PLAYLIST.forEach(function(item, i){
      var b = document.createElement("button");
      b.className = "tab";
      b.textContent = (i+1) + ". " + item.title;
      b.setAttribute("data-yt", item.id);
      if(item.id === last){ b.setAttribute("aria-current","true"); }
      b.addEventListener("click", function(){
        last = item.id; localStorage.setItem("froot:last_video", last);
        setIframe(last, true);
        trackTabs.querySelectorAll(".tab[aria-current]").forEach(function(x){ x.removeAttribute("aria-current"); });
        b.setAttribute("aria-current","true");
      }, {passive:true});
      trackTabs.appendChild(b);
    });
  }
  renderTabs();

  // Tint overlay (instant responsiveness)
  function setOverlay(color, pct){
    var c = hexToRgb(color||DEFAULT_TINT);
    var a = Math.max(0, Math.min(1, (pct||0)/100));
    overlay.style.background = "rgba("+c.r+","+c.g+","+c.b+","+a+")";
  }

  // Build tint dots from a fixed palette (Marina-ish lilacs + honey)
  var DOTS = ["#A89FBF","#F7C873","#8C5FE0","#6AB6FF","#ffb3c7","#ffd26f"];
  function renderDots(){
    tintDots.innerHTML = "";
    var savedColor = localStorage.getItem("froot:tint_color") || DEFAULT_TINT;
    DOTS.forEach(function(h,i){
      var d = document.createElement("button");
      d.className = "tintDot";
      d.style.background = h; d.title = h; d.setAttribute("aria-label", h);
      if(h.toLowerCase() === savedColor.toLowerCase()){ d.setAttribute("aria-current","true"); }
      d.addEventListener("click", function(){
        tintDots.querySelectorAll(".tintDot[aria-current]").forEach(function(x){ x.removeAttribute("aria-current"); });
        d.setAttribute("aria-current","true");
        localStorage.setItem("froot:tint_color", h);
        setOverlay(h, parseInt(tintPctMini.value,10));
      }, {passive:true});
      tintDots.appendChild(d);
    });
  }
  renderDots();

  // Restore tint pct + color
  var savedPct = parseInt(localStorage.getItem("froot:tint_pct")||DEFAULT_TINT_PCT,10);
  tintPctMini.value = isNaN(savedPct) ? DEFAULT_TINT_PCT : savedPct;
  tintChipMini.textContent = (tintPctMini.value|0) + "%";
  var savedColor = localStorage.getItem("froot:tint_color") || DEFAULT_TINT;
  setOverlay(savedColor, parseInt(tintPctMini.value,10));

  tintPctMini.addEventListener("input", function(){
    var v = parseInt(tintPctMini.value,10);
    tintChipMini.textContent = v + "%";
    localStorage.setItem("froot:tint_pct", v);
    var c = localStorage.getItem("froot:tint_color") || DEFAULT_TINT;
    setOverlay(c, v);
  }, {passive:true});

  // Pin / Unpin mini-player (reliable on mobile)
  function applyPinned(pinned){
    if(pinned){ yt.classList.add("player--pinned"); pinBtn.setAttribute("aria-pressed","true"); pinBtn.textContent = "📌 Unpin Video"; }
    else{ yt.classList.remove("player--pinned"); pinBtn.setAttribute("aria-pressed","false"); pinBtn.textContent = "📌 Pin Video"; }
  }
  var pinned = localStorage.getItem("froot:pin")==="1";
  applyPinned(pinned);
  pinBtn.addEventListener("click", function(){
    pinned = !pinned; localStorage.setItem("froot:pin", pinned ? "1":"0"); applyPinned(pinned);
  }, {passive:true});

  // Mute toggle (best-effort; iframe API is limited without JS API key)
  // We emulate by swapping autoplay on next src set; also provide visual state.
  function applyMuteState(muted){
    muteBtn.setAttribute("aria-pressed", muted ? "true":"false");
    muteBtn.textContent = muted ? "🔇 Muted" : "🔊 Mute";
  }
  var muted = localStorage.getItem("froot:mute")==="1";
  applyMuteState(muted);
  muteBtn.addEventListener("click", function(){
    muted = !muted; localStorage.setItem("froot:mute", muted ? "1":"0");
    applyMuteState(muted);
    // Soft “mute” UX: reload current video without autoplay; user can adjust device volume
    setIframe(last, false);
  }, {passive:true});

  // Ensure inline playback hint for iOS
  yt.setAttribute("playsinline","");

  // Safety: if navigating away, nothing special to stop
  window.addEventListener("pagehide", function(){}, {passive:true});
</script>
</body>
</html>
