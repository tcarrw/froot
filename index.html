<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1,user-scalable=no" />
<title>FROOT â€” Illumina 1 Â· Anchors Â· Week Map</title>
<meta name="theme-color" content="#0b0d11" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="description" content="FROOT Â· Illumina 1 anchors, tones, EQ, AirPlay, altar, tint overlay, feel test, queue + mini-player. Week mapping and Day 14 link." />
<style>
:root{
  --bg:#0b0d11;--ink:#f6f3ff;--muted:#bfc3d9;--border:rgba(255,255,255,.1);
  --maxw:1100px;--radius:18px;--shadow:0 16px 36px rgba(0,0,0,.35)
}
*{box-sizing:border-box}
html,body{margin:0;height:100%;background:linear-gradient(180deg,#0b0d11 0%,#0b0d11 60%,#0a0a12 100%);color:var(--ink);
  font:400 16px/1.55 ui-sans-serif,system-ui,-apple-system,Inter,Roboto,"Helvetica Neue",Arial;-webkit-text-size-adjust:100%}
header{position:sticky;top:0;z-index:50;background:color-mix(in oklab,#101422 90%, transparent);border-bottom:1px solid var(--border);backdrop-filter:blur(8px)}
.hinner{max-width:var(--maxw);margin:0 auto;display:flex;gap:10px;align-items:center;min-height:56px;padding:8px 16px}
.brand{font-weight:900;display:flex;gap:10px;align-items:center}
.badge{padding:8px 12px;border:1px solid var(--border);border-radius:999px;background:#171b2c;font-weight:800}
.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid var(--border);background:#171b2c;color:var(--ink);font-weight:800;min-height:44px;text-decoration:none}
main{max-width:var(--maxw);margin:0 auto;padding:16px}
.hero{display:grid;grid-template-columns:1fr;gap:12px;margin-top:10px}
.player{position:relative;border:1px solid var(--border);border-radius:14px;overflow:hidden;box-shadow:var(--shadow);background:#000}
#ytwrap{position:relative;width:100%;aspect-ratio:16/9}
#ytframe{position:absolute;inset:0;width:100%;height:100%;border:0}
.controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center;padding:8px}
.tabs{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
.tabs-compact{margin-top:6px}
.tabs .tab,.tabs-compact .tab{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:10px;border:1px solid var(--border);background:#141a2e;color:var(--ink);font-weight:800;min-height:42px}
.tabs-compact .tab{padding:6px 10px;min-height:34px;font-size:13px}
.qrow{display:flex;gap:10px;overflow:auto;padding:8px 0}
.card{margin-top:14px;border:1px solid var(--border);border-radius:14px;padding:14px;background:#12182e;box-shadow:var(--shadow)}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:10px}
.pinmini{position:fixed;right:12px;bottom:calc(12px + env(safe-area-inset-bottom));z-index:60;border:1px solid var(--border);background:#12182e;border-radius:14px;box-shadow:var(--shadow);padding:10px;display:none;min-width:260px}
.pinmini.show{display:block}
.tintrail{position:fixed;left:12px;bottom:calc(12px + env(safe-area-inset-bottom));z-index:60;border:1px solid var(--border);background:#12182e;border-radius:14px;box-shadow:var(--shadow);padding:10px;display:flex;gap:8px;align-items:center}
#tintOverlay{position:fixed;inset:0;pointer-events:none;background:radial-gradient(1200px 900px at 30% 15%, rgba(255,205,120,.12), transparent 60%),radial-gradient(1000px 900px at 70% 85%, rgba(194,183,235,.1), transparent 60%);opacity:.4;transition:opacity .2s ease}
footer{margin:28px 0 80px;display:flex;gap:10px;flex-wrap:wrap}
@media (min-width:920px){.hero{grid-template-columns:1.15fr .85fr}}
</style>
</head>
<body>
<header>
  <div class="hinner">
    <div class="brand">FROOT Â· Illumina 1</div>
    <div style="flex:1"></div>
    <a class="btn" href="/day14/" rel="noopener">Day 14</a>
    <a class="btn" href="https://time.plnt.earth" target="_blank" rel="noopener">Ï‡ Calibrated</a>
    <a class="btn" href="https://github.com/tcarrw/time" target="_blank" rel="noopener">GitHub: tcarrw/time</a>
  </div>
</header>

<main>
  <section class="hero">
    <div class="player">
      <div id="ytwrap"><div id="ytframe"></div></div>
      <div class="controls">
        <button class="btn" id="start">â–¶ï¸Ž Start / Enable Audio</button>
        <div class="badge" id="toneBadge">Tone: Off</div>
        <button class="btn" data-freq="0">Off</button>
        <button class="btn" data-freq="128">128 Hz</button>
        <button class="btn" data-freq="160">160 Hz</button>
        <div style="flex:1"></div>
        <button class="btn" id="pinMini">ðŸ“Œ Mini</button>
        <a class="btn" id="openInYT" href="#" target="_blank" rel="noopener">â†— Open</a>
      </div>
    </div>

    <section class="card">
      <h3 style="margin:0 0 8px">Altar Â· Feel Test Â· EQ</h3>
      <div class="grid">
        <div>
          <div class="badge">Altar</div>
          <p style="color:var(--muted)">Tap a color to set mood; altar animates with tint overlay.</p>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn" data-tint="10">Light</button>
            <button class="btn" data-tint="35">Medium</button>
            <button class="btn" data-tint="60">Deep</button>
          </div>
        </div>
        <div>
          <div class="badge">Feel Test (30s)</div>
          <p style="color:var(--muted)">Play, then check-in: root (128) vs lift (160). Adjust tint if needed.</p>
          <div style="display:flex;gap:8px;flex-wrap:wrap"><button class="btn" id="ftest">Start 30s</button></div>
        </div>
        <div>
          <div class="badge">EQ</div>
          <p style="color:var(--muted)">Quick tilt: - bass / + air. (Client side)</p>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn" data-eq="flat">Flat</button>
            <button class="btn" data-eq="warm">Warm</button>
            <button class="btn" data-eq="air">Air</button>
          </div>
        </div>
      </div>
    </section>
  </section>

  <div class="tabs" role="tablist" aria-label="Anchors">
    <button class="tab active" aria-selected="true" data-artist="marina">Marina</button>
    <button class="tab" data-artist="sabrina">Sabrina</button>
    <button class="tab" data-artist="sigrid">Sigrid</button>
    <button class="tab" data-artist="ariana">Ariana</button>
    <button class="tab" data-artist="swift">Swift</button>
    <button class="tab" data-artist="doechii">Doechii</button>
    <button class="tab" data-artist="flow">FLOW</button>
  </div>

  <div class="tabs tabs-compact" role="tablist" aria-label="Anchors (compact)">
    <button class="tab" data-artist="marina">Marina</button>
    <button class="tab" data-artist="sabrina">Sabrina</button>
    <button class="tab" data-artist="sigrid">Sigrid</button>
    <button class="tab" data-artist="ariana">Ariana</button>
    <button class="tab" data-artist="swift">Swift</button>
    <button class="tab" data-artist="doechii">Doechii</button>
    <button class="tab" data-artist="flow">FLOW</button>
  </div>

  <div class="qrow" id="queueStrip"></div>

  <section class="card" id="dailyPages">
    <h2>Daily Pages</h2>
    <p style="color:var(--muted)">Find focused day spreads synced to Illumina 1.</p>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <a class="btn" href="/day14/">Day 14 â€” Sabrina: Tornado Warnings</a>
    </div>
  </section>

  <footer>
    <a class="btn" href="https://mirrorhoney.plnt.earth" target="_blank" rel="noopener">MirrorHoney</a>
    <a class="btn" href="https://time.plnt.earth" target="_blank" rel="noopener">Ï‡ Calibrated</a>
  </footer>
</main>

<div id="tintOverlay"></div>
<div class="pinmini" id="mini">
  <div style="display:flex;gap:8px;align-items:center;justify-content:space-between">
    <strong>Mini Player</strong>
    <button class="btn" id="closeMini">âœ•</button>
  </div>
  <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap">
    <button class="btn" data-freq="0">Off</button>
    <button class="btn" data-freq="128">128</button>
    <button class="btn" data-freq="160">160</button>
    <a class="btn" id="openMiniYT" href="#" target="_blank" rel="noopener">â†— Open</a>
  </div>
</div>
<div class="tintrail" id="trail" style="display:none"></div>

<script>
/* ====== SETTINGS ====== */
var useNoCookie=true; // flip if you want full youtube domain
var SPOTLIGHT_ORDER=["marina","sabrina","sigrid","ariana","swift","doechii"]; // week mapping

/* ====== DATA (preserve all songs) ====== */
var DATA={
  marina:{
    palette:["#93B1FF","#C6E2FF","#A9C6FF","#3E6BFF","#2B3C64"],
    songs:[
      {t:"Oh No!",id:"smn1NBD3Itk"},
      {t:"Are You Satisfied?",id:"Qv4T4rZ6ryM"},
      {t:"Teen Idle",id:"G6dQ-0d_7rQ"},
      {t:"Blue",id:"l3yXKla0xEI"}
    ]
  },
  sabrina:{
    palette:["#F5B942","#FFDFA0","#C8B9DD","#B6A9CF","#5E5380"],
    songs:[
      {t:"Tornado Warnings",id:"wP4JsTRPSsA"},
      {t:"Feather",id:"7F37r50VUTQ"}
    ]
  },
  sigrid:{
    palette:["#94F0FF","#D4FBFF","#B9F4FF","#52D8F2","#1E3F46"],
    songs:[
      {t:"Strangers",id:"eC-F_VZ2T1g"},
      {t:"Donâ€™t Kill My Vibe",id:"44Id1a_z6E8"}
    ]
  },
  ariana:{
    palette:["#FAD4E1","#FFE8F1","#EFD1E6","#C684A6","#42293E"],
    songs:[
      {t:"yes, and?",id:"L5Pw3k06f0I"},
      {t:"pov",id:"XStmX0JfHgQ"}
    ]
  },
  swift:{
    palette:["#CDB4DB","#FFC8DD","#FFAFCC","#BDE0FE","#A2D2FF"],
    songs:[
      {t:"All Too Well (10 Minute Version)",id:"tollGa3S0o8"},
      {t:"Lavender Haze",id:"mkR_Qwix4Ho"}
    ]
  },
  doechii:{
    palette:["#F8A1C4","#FFD6E8","#C7F3AA","#9CF6F6","#2D2A55"],
    songs:[
      {t:"What It Is",id:"5oZgD6nbK6s"},
      {t:"Crazy",id:"hz1wZ-fJUOk"}
    ]
  }
};

/* ====== STATE ====== */
var AC=null,osc=null,gain=null,toneOn=false,player=null,playerReady=false,currentQueue=[],currentQueueIds=[],currentArtist="marina";

/* ====== AUDIO ENGINE (tones) ====== */
function ensureAudio(){ if(AC) return true; try{ AC=new (window.AudioContext||window.webkitAudioContext)(); gain=AC.createGain(); gain.gain.value=0.0; osc=AC.createOscillator(); osc.type='sine'; osc.frequency.value=440; osc.connect(gain); gain.connect(AC.destination); osc.start(); return true; }catch(e){ return false; } }
function setFreq(freq){ if(!ensureAudio()) return; if(AC.state==='suspended'){ AC.resume(); } var t=AC.currentTime; if(freq>0){ osc.frequency.setValueAtTime(freq,t); gain.gain.cancelScheduledValues(t); gain.gain.setTargetAtTime(.22,t,.05); document.getElementById('toneBadge').textContent='Tone: '+freq+' Hz'; } else { gain.gain.setTargetAtTime(0.0,t,.06); document.getElementById('toneBadge').textContent='Tone: Off'; } }

/* ====== YOUTUBE API ====== */
function ensureYTAPI(){ if(window.YT && window.YT.Player) return true; var s=document.createElement('script'); s.src='https://www.youtube.com/iframe_api'; document.head.appendChild(s); return false; }
function onYouTubeIframeAPIReady(){ createPlayer(); }
function playerHost(){ return useNoCookie ? 'https://www.youtube-nocookie.com' : 'https://www.youtube.com'; }
function createPlayer(){ if(player){ try{player.destroy();}catch(_){ } player=null; }
  player=new YT.Player('ytframe',{height:'100%',width:'100%',host:playerHost(),playerVars:{origin:location.origin,rel:0,modestbranding:1,playsinline:1,autoplay:1,loop:1,controls:1,color:'white'},events:{onReady:()=>{playerReady=true; try{player.mute();}catch(_){ } try{player.playVideo();}catch(_){ } cueIntoPlayer();}, onStateChange:onPlayerStateChange, onError:handlePlayerError}}); }
function handlePlayerError(){ /* fallback could rotate id */ }
function onPlayerStateChange(e){ if(e.data===YT.PlayerState.ENDED){ nextInQueue(); } }
function updateOpenInYT(){ var id=currentQueueIds && currentQueueIds[0] || null; if(!id){ document.getElementById('openInYT').href='#'; document.getElementById('openMiniYT').href='#'; return; } var base= useNoCookie? 'https://www.youtube-nocookie.com/watch?v=' : 'https://www.youtube.com/watch?v='; var url=base+id; document.getElementById('openInYT').href=url; document.getElementById('openMiniYT').href=url; }

/* ====== QUEUE ====== */
function setQueueFromAnchor(key,opts){ opts=opts||{}; currentArtist=key; currentQueue=(DATA[key].songs||[]).slice(); currentQueueIds=currentQueue.map(s=>s.id); renderQueueStrip(); (opts&&opts.cueOnly)?cueIntoPlayer():loadIntoPlayer(); }
function buildFlow(opts){ // demo flow: first of each anchor
  var list=[]; SPOTLIGHT_ORDER.forEach(k=>{ if(DATA[k]&&DATA[k].songs&&DATA[k].songs[0]) list.push(DATA[k].songs[0]); }); currentQueue=list; currentQueueIds=list.map(s=>s.id); renderQueueStrip(); (opts&&opts.cueOnly)?cueIntoPlayer():loadIntoPlayer(); }
function nextInQueue(){ if(!currentQueueIds||!currentQueueIds.length) return; currentQueueIds.push(currentQueueIds.shift()); cueIntoPlayer(); }
function loadIntoPlayer(){ if(!playerReady||!player||!currentQueueIds||!currentQueueIds.length) return; try{ player.loadPlaylist({playlist:currentQueueIds,index:0,startSeconds:0}); }catch(_){ } setTimeout(updateOpenInYT,300); }
function cueIntoPlayer(){ if(!playerReady||!player||!currentQueueIds||!currentQueueIds.length) return; try{ player.cuePlaylist({playlist:currentQueueIds,index:0,startSeconds:0}); player.playVideo(); }catch(_){ } setTimeout(updateOpenInYT,300); }

/* ====== RENDER ====== */
function renderQueueStrip(){ var el=document.getElementById('queueStrip'); el.innerHTML=''; currentQueue.forEach((s,idx)=>{ var b=document.createElement('button'); b.className='btn'; b.textContent=(idx+1)+" Â· "+s.t; b.addEventListener('click',function(){ // rotate queue so chosen is first
  var i=idx; while(i-->0){ currentQueueIds.push(currentQueueIds.shift()); } cueIntoPlayer(); }); el.appendChild(b); }); }
function renderArtist(key){ document.querySelectorAll('.tab').forEach(x=>{ x.classList.toggle('active', x.getAttribute('data-artist')===key); x.setAttribute('aria-selected', x.classList.contains('active')?'true':'false'); }); }

/* ====== UI BINDINGS ====== */
document.getElementById('start').addEventListener('click',function(){ ensureYTAPI(); ensureAudio(); setFreq(128); });
document.querySelectorAll('[data-freq]').forEach(b=> b.addEventListener('click', function(){ setFreq(parseInt(this.getAttribute('data-freq')||'0',10)); }));
document.getElementById('pinMini').addEventListener('click',function(){ document.getElementById('mini').classList.add('show'); });
document.getElementById('closeMini').addEventListener('click',function(){ document.getElementById('mini').classList.remove('show'); });

document.querySelectorAll('.tab').forEach(function(t){
  t._boundTab = true;
  t.addEventListener('click', function(){
    document.querySelectorAll('.tab').forEach(x=>{x.classList.remove('active'); x.setAttribute('aria-selected','false');});
    t.classList.add('active'); t.setAttribute('aria-selected','true');
    var artist=t.getAttribute('data-artist'); renderArtist(artist);
    if(artist==="flow"){ buildFlow({cueOnly:true}); } else { setQueueFromAnchor(artist,{cueOnly:true}); }
  });
});

function bindAllTabs(){
  document.querySelectorAll('.tab').forEach(function(t){
    if(t._boundTab) return;
    t._boundTab = true;
    t.addEventListener('click', function(){
      document.querySelectorAll('.tab').forEach(x=>{x.classList.remove('active'); x.setAttribute('aria-selected','false');});
      t.classList.add('active'); t.setAttribute('aria-selected','true');
      var artist=t.getAttribute('data-artist'); renderArtist(artist);
      if(artist==="flow"){ buildFlow({cueOnly:true}); } else { setQueueFromAnchor(artist,{cueOnly:true}); }
    });
  });
}

/* TINT OVERLAY */
function setTint(p){ p=Math.max(0,Math.min(100,Math.round(p))); document.getElementById('tintOverlay').style.opacity=(0.15+(p/100)*0.55).toFixed(2); }

document.querySelectorAll('[data-tint]').forEach(b=> b.addEventListener('click',function(){ setTint(parseInt(this.getAttribute('data-tint'),10)); }));

document.getElementById('ftest').addEventListener('click', function(){ var seq=[128,0,160,0]; var i=0; function step(){ setFreq(seq[i++%seq.length]); if(i<seq.length*2) setTimeout(step,7500); } step(); });

document.addEventListener('DOMContentLoaded',function(){ ensureYTAPI(); setTint(35); bindAllTabs(); setQueueFromAnchor('marina',{cueOnly:false}); });
</script>
</body>
</html>
